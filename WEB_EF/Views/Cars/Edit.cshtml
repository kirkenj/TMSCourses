@using WebApi.Models.Entities
@model Car

@{
    if (!(ViewData["Clients"] != null && ViewData["Clients"] is List<Client> clients))
    {
        throw new ArgumentException("Clients");
    }

    if (!(ViewData["CarTypes"] != null && ViewData["CarTypes"] is List<CarType> carTypes))
    {
        throw new ArgumentException("CarTypes");
    }

    var clientsSelection = clients.Select(c => new SelectListItem { Value = c.Id.ToString(), Text = c.Name + ' ' + c.Surname }).ToList();
    clientsSelection.Add(new SelectListItem { Value = null, Text = "Not set" });
}

<form method = "post">
    <table>
        <tr>
            @(ViewData["Message"] ?? string.Empty)
            @Html.HiddenFor(m => m.Id)
        </tr>
        <tr>
            <td>@Html.LabelFor(m=>m.RegNumber)</td> <td>@Html.TextBoxFor(m=>m.RegNumber)</td>
        </tr>
        <tr>
            <td>@Html.LabelFor(m=>m.Client)</td> <td>@Html.DropDownListFor(m=>m.ClientId, clientsSelection)</td>    
        </tr>
        <tr>
            <td>@Html.LabelFor(m=>m.CarType)</td> <td>@Html.DropDownListFor(m=>m.CarType, carTypes.Select(c=> new SelectListItem{Value = c.Id.ToString(), Text = c.TypeName}))</td>    
        </tr>
    </table>   
    <button type = "submit">Save</button>
</form>